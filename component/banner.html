<!--logo-->
<script>
    avalon.ready(function () {
        var vm = avalon.define({
            $id: "bannerVm",
            curPage: "",
            pops: "",
            user: {},
            user_id: "",
            addUsername: "",
            addOtherName: "",
            addSex: 0,
            addDate: "",
            addRemark: "",
            blo: false,
            revUrl: "http://www.kh122.com:8081/ChildrenBackstage/backstageServlet/userApi/editUserInfo",
            popData: {},


            router: function () {
                vm.blo = true
                console.log(vm.blo);
                vm.popData = {
                    isLegal: function () {
                        var data = vm.popData.collecData();
                        console.log(data);
                        if (data.user_id == 0 || data.name.trim() == "") {
                            return false;
                        } else {
                            return true;
                        }
                    },
                    collecData: function () {
                        return {
                            user_id: vm.user.user_id,
                            name: vm.addOtherName,
                            sex: vm.addSex,
                            birthday: vm.addDate,
                            remark: vm.addRemark
                        }
                    }
                }
            },
            loginOut: function () {
                localStorage.removeItem('user');
                window.location.href = "./login.html"
            },
            close: function () {
                vm.blo = false;
            },
            rev: function () {
                var check = vm.popData.isLegal();
                if (check) {
                    $.ajax({url: vm.revUrl, type: "post", data: vm.popData.collecData()}).done(function (data) {
                        vm.close();
                    })
                } else {
                    layer.msg("请填写完整")
                }


            },
            init: function () {
                var page = window.location.pathname;
                vm.user = getLocalValue("user");
                console.log(vm.user.name);
                vm.addOtherName = vm.user.name;
                console.log(vm.addOtherName)
                vm.addSex = vm.user.sex;
                vm.addData = vm.user.birthday;
                vm.addRemark = vm.user.remark;
                if (page == '/oa/device.html') {
                    vm.curPage = "device"
                }
                if (page == '/oa/admin.html') {
                    vm.curPage = "admin"
                }
                if (page == '/oa/goods.html') {
                    vm.curPage = "goods"
                }
                if (page == '/oa/video.html') {
                    vm.curPage = "video"
                }
                if (page == '/oa/statement.html') {
                    vm.curPage = "statement"
                }
            }
        })
        vm.init();
        avalon.scan()

    })

</script>


<div ms-important="bannerVm" class="baby_top">
    <div class="baby_top_logo">
        <a href="javascript:location.reload()">
            <img src="img/logo.png" title="">
        </a>
        <div class="baby_top_p">
            <p class="baby_top_p_1">伴小宝</p>
            <p class="baby_top_p_2">幼儿安全健康管理</p>
        </div>
    </div>

    <!--导航-->
    <div class="baby_top_nav">
        <a href="/oa/device.html" ms-class="baby_top_list:curPage=='device' ">
            <img src="img/device.png" title="">
            <p>设备管理</p>
        </a>

        <a href="/oa/admin.html" ms-class="baby_top_list:curPage=='admin' ">
            <img src="img/num.png" title="">
            <p>用户管理</p>
        </a>

        <a href="/oa/goods.html" ms-class="baby_top_list:curPage=='goods' ">
            <img src="img/health.png" title="">
            <p>商城管理</p>
        </a>

        <a href="/oa/video.html" ms-class="baby_top_list:curPage=='video' ">
            <img src="img/attentop.png" title="">
            <p>讲堂管理</p>
        </a>

        <a href="/oa/statement.html" ms-class="baby_top_list:curPage=='statement' ">
            <img src="img/statement.png" title="">
            <p>报表管理</p>
        </a>
    </div>

    <!--右侧附加信息-->
    <div class="baby_top_rig">
        <div class="baby_top_rig_a">
            <a class="baby_a_border">
                <img src="img/help.png" title="">
                <span>帮助</span>
            </a>
            <a class="baby_a_border">关于</a>
            <a ms-click="loginOut">退出</a>
        </div>

        <div class="baby_top_rig_info">
            <div class="baby_top_info_pad">
                <p class="baby_info_user">{{addOtherName}}</p>
                |
                <strong><a id="example" style="color: #999;cursor:pointer" title="个人设置"
                           ms-click="router">个人设置 </a></strong>
            </div>
        </div>
    </div>
    <!-- 个人设置 -->
    <div class="shade" ms-class="block:blo==true">
        <div class="user-edit">
            <div class="user-main">
                <div class="user-title">
                    <h3>个人信息：</h3>
                </div>
                <table class="table_1" cellpadding="0" cellspacing="0">
                    <tr>
                        <th width="40%">昵称：</th>
                        <td width="60%"><input type="text" name="" ms-duplex="addOtherName"/>
                        </td>
                    </tr>
                    <tr>
                        <th width="40%">性别：</th>
                        <td width="60%"><select name="" ms-duplex="addSex">
                            <option value="0">男</option>
                            <option value="1">女</option>
                        </select>
                        </td>
                    </tr>
                    <tr>
                        <th width="40%">生日：</th>
                        <td width="60%"><input type="date" name="" ms-duplex="addDate"/></td>
                    </tr>
                    <tr>
                        <th width="40%">个性签名：</th>
                        <td width="60%"><input type="text" name="" ms-duplex="addRemark"/>
                        </td>
                    </tr>
                </table>
                <div class="user-btn">
                    <input type="button" value="保存" class="oper" ms-click="rev"/>
                    <input type="button" value="返回" class="oper" ms-click="close"/>
                </div>
            </div>
        </div>
    </div>

</div>









